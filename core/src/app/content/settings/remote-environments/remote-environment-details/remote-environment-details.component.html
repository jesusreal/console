<section class="fd-section">
  <fd-breadcrumb>
    <fd-breadcrumb-item>
      <a fd-breadcrumb-link (click)="navigateToList()" href="#">
        Applications
      </a>
    </fd-breadcrumb-item>
    <fd-breadcrumb-item>
      <span fd-breadcrumb-link>
        {{ currentREnvId }}
      </span>
    </fd-breadcrumb-item>
  </fd-breadcrumb>

  <fd-action-bar>
    <fd-action-bar-header>
      <fd-action-bar-title>
        {{ currentREnvId }}
      </fd-action-bar-title>
    </fd-action-bar-header>
    <fd-action-bar-actions>
      <button fd-button [options]="'light'" *ngIf="connectorServiceUrl || connectorServiceError"
        (click)="fetchUrl()">
          Connect Application
      </button>
    </fd-action-bar-actions>
  </fd-action-bar>

  <ng-container *ngIf="remoteEnvironment">
    <fd-panel>
      <fd-panel-header>
        <fd-panel-head>
          <fd-panel-title>General Information</fd-panel-title>
        </fd-panel-head>
        <fd-panel-actions>
          <button fd-button [options]="'light'" (click)="openEditRemoteEnvModal()">
            Edit
          </button>
        </fd-panel-actions>
      </fd-panel-header>

      <fd-panel-body [bleed]="true">
        <fd-panel-grid [col]="6" [nogap]="true">
          <fd-panel [columnSpan]="1">
            <fd-panel-body>
              <label class="fd-has-color-text-4">Name</label>
            </fd-panel-body>
          </fd-panel>
          <fd-panel [columnSpan]="5">
            <fd-panel-body>
              {{ remoteEnvironment.name }}
            </fd-panel-body>
          </fd-panel>
          <fd-panel [columnSpan]="1">
            <fd-panel-body>
              <label class="fd-has-color-text-4">Status</label>
            </fd-panel-body>
          </fd-panel>
          <fd-panel [columnSpan]="5">
            <fd-panel-body>
              <span class="fd-status-label" [ngClass]="determineClass(remoteEnvironment)">{{ prettyStatus }}</span>
            </fd-panel-body>
          </fd-panel>
          <fd-panel [columnSpan]="1">
            <fd-panel-body>
              <label class="fd-has-color-text-4">Description</label>
            </fd-panel-body>
          </fd-panel>
          <fd-panel [columnSpan]="5">
            <fd-panel-body>
              <ng-container *ngIf="remoteEnvironment.description">
                {{ remoteEnvironment.description }}
              </ng-container>
              <ng-container *ngIf="!remoteEnvironment.description">
                <span class="fd-has-font-style-italic fd-has-color-text-4">none</span>
              </ng-container>
            </fd-panel-body>
          </fd-panel>
          <fd-panel [columnSpan]="1">
            <fd-panel-body>
              <label class="fd-has-color-text-4">Labels</label>
            </fd-panel-body>
          </fd-panel>
          <fd-panel [columnSpan]="5" class="sf-list__label-column">
            <fd-panel-body>
              <ng-container *ngIf='transformedLabels.length'>
                <span class="fd-token" role="button" *ngFor="let label of transformedLabels">
                  {{ label }}
                </span>
              </ng-container>
              <ng-container *ngIf='!transformedLabels.length'>
                <span class="fd-has-font-style-italic fd-has-color-text-4">none</span>
              </ng-container>
            </fd-panel-body>
          </fd-panel>
        </fd-panel-grid>
      </fd-panel-body>
    </fd-panel>
  </ng-container>
</section>

<ng-container *ngIf="remoteEnvironment">
  <section class="fd-section">
    <fd-panel>
      <fd-panel-header>
        <fd-panel-head>
          <fd-panel-title>Namespace Bindings</fd-panel-title>
        </fd-panel-head>
        <fd-panel-actions>
          <button fd-button [options]="'light'" (click)="openEditBindingsModal()">
            + Create Binding
          </button>
        </fd-panel-actions>
      </fd-panel-header>

      <fd-panel-body [bleed]="true">
        <fd-table *ngIf="boundEnvironments.length > 0">
          <fd-table-header>
            <th>Name</th>
            <th class="fd-table__th--min">Actions</th>
          </fd-table-header>
          <fd-table-body>
            <tr *ngFor="let environment of boundEnvironments">
              <td><span class="fd-has-font-weight-bold">{{ environment }}</span></td>
              <td>
                <y-list-actions [entry]="environment" [entryEventHandler]="entryEventHandler"
                                [actions]="actions"></y-list-actions>
              </td>
            </tr>
          </fd-table-body>
        </fd-table>
      </fd-panel-body>
    </fd-panel>
  </section>

  <section class="fd-section" *ngIf="remoteEnvironment.services.length > 0">
    <fd-panel>
      <fd-panel-header>
        <fd-panel-head>
          <fd-panel-title>Provided Services & Events</fd-panel-title>
        </fd-panel-head>
      </fd-panel-header>
      <fd-panel-body [bleed]="true">
        <fd-table>
          <fd-table-header>
            <th>ServiceClass Name</th>
            <th class="fd-table__th--min">API</th>
            <th class="fd-table__th--min">Events</th>
          </fd-table-header>
          <fd-table-body>
            <tr *ngFor="let service of remoteEnvironment.services">
              <td><span class="fd-has-font-weight-bold">{{ service.displayName }}</span></td>
              <td>
                <span class="sap-icon--l"
                      ngClass="{{hasType(service.entries, 'API') ? 'sap-icon--accept' : 'sap-icon--decline'}}"
                      role="presentation">
                </span>
              </td>
              <td>
                <span class="sap-icon--l"
                      ngClass="{{hasType(service.entries, 'Events') ? 'sap-icon--accept' : 'sap-icon--decline'}}"
                      role="presentation">
                </span>
              </td>
            </tr>
          </fd-table-body>
        </fd-table>
      </fd-panel-body>
    </fd-panel>
  </section>
</ng-container>

<app-copy2clipboard-modal #fetchModal></app-copy2clipboard-modal>
<app-edit-bindings-modal #editbindingsmodal></app-edit-bindings-modal>
<app-information-modal #infoModal></app-information-modal>
<app-edit-remote-environment-modal #editRemoteEnvModal *ngIf="remoteEnvironment"
    [name]="remoteEnvironment.name"
    [initialDescription]="remoteEnvironment.description"
    [initialLabels]="transformedLabels">
  </app-edit-remote-environment-modal>


