<div luigiClientCommunication [isActive]="isActive">
  <fd-modal #createBindingModal role="dialog" aria-labelledby="confirm" (click)="$event.stopPropagation()">
        <fd-modal-header>Create Binding</fd-modal-header>
        <fd-modal-body>
          <div class="fd-form__group">
            <div class="fd-alert fd-alert--error fd-has-margin-bottom-small" role="alert" *ngIf="error">{{ error }}</div>
            
            <label class="fd-form__label">UserGroup</label>
            <input fd-form__control
              class="fd-form__control y-fd-form__control"
              type="text" 
              name="userGroup"
              placeholder="Enter User Group"
              [(ngModel)]="userGroup"
              (ngModelChange)="validateUserGroupInput()"
              autocomplete="off">
            <div *ngIf="userGroupError" class="fd-alert fd-alert--error fd-has-margin-bottom-small" role="alert">{{ userGroupError }}</div>

            <div class="fd-dropdown y-fd-dropdown fd-has-display-block" *ngIf="!isGlobalPermissionsView">
              <label class="fd-form__label">Kind</label>
              <div (clickOutside)="closeDropDown('Kind')" clickOutsideEvents="click,mousedown" excludeBeforeClick="true">
                <button class="fd-dropdown__control y-fd-dropdown__control fd-button fd-has-padding-none"
                  ngClass="{{!selectedKind ? 'fd-dropdown__control--placeholder' : ''}}"
                  [attr.aria-expanded]="ariaExpandedKind"
                  aria-controls="kinds"
                  (click)="toggleDropDown('Kind')">
                  <input fd-form__control
                    class="fd-form__control y-fd-form__control"
                    type="text" 
                    name="selectedKind"
                    placeholder="Select Kind"
                    [(ngModel)]="selectedKind"
                    (ngModelChange)="filterEnvironments('Kind')"
                    (keydown)="openDropDown('Kind', $event)"
                    (click)="openDropDown('Kind', $event)"
                    autocomplete="off">
                </button>
                <div class="fd-popover__body fd-popover__body--no-arrow y-fd-popover__body" [attr.aria-hidden]="!ariaExpandedKind" id="kinds">
                  <div class="fd-menu">
                    <ul class="fd-menu__list">
                      <li class="fd-menu__item" *ngFor="let kind of filteredKinds" (click)="closeDropDown(); selectKind(kind);">
                        {{ kind }}
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>

            <div class="fd-dropdown y-fd-dropdown fd-has-display-block">
              <label class="fd-form__label">Role</label>
              <div (clickOutside)="closeDropDown('Role')" clickOutsideEvents="click,mousedown" excludeBeforeClick="true">
                <button class="fd-dropdown__control y-fd-dropdown__control fd-button fd-has-padding-none"
                  ngClass="{{!selectedRole ? 'fd-dropdown__control--placeholder' : ''}}"
                  [disabled]="!selectedKind"
                  [attr.aria-expanded]="ariaExpandedRole"
                  aria-controls="roles"
                  (click)="toggleDropDown('Role')">
                  <input fd-form__control
                    class="fd-form__control y-fd-form__control"
                    type="text" 
                    name="selectedRole"
                    placeholder="Select Role"
                    [disabled]="!selectedKind"
                    [(ngModel)]="selectedRole"
                    (ngModelChange)="filterEnvironments('Role')"
                    (keydown)="openDropDown('Role', $event)"
                    (click)="openDropDown('Role', $event)"
                    autocomplete="off">
                </button>
                <div class="fd-popover__body fd-popover__body--no-arrow y-fd-popover__body" [attr.aria-hidden]="!ariaExpandedRole" id="roles">
                  <div class="fd-menu">
                    <ul class="fd-menu__list">
                      <li class="fd-menu__item" *ngFor="let role of filteredRoles" (click)="closeDropDown(); selectRole(role);">
                        {{ role }}
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </fd-modal-body>
        <fd-modal-footer>
          <button fd-button
            [options]="'emphasized'"
            [state]="(!isReadyToCreate() || error) ? 'disabled' : ''"
            (click)="save()">
            SAVE
          </button>
        </fd-modal-footer>
  </fd-modal>
</div>
